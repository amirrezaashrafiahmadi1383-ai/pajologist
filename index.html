<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>پژولوژیست | فراتر از کارگاه</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Vazirmatn', sans-serif; background-color: #f4f7f6; direction: rtl; padding: 20px; margin: 0; }
        .container { max-width: 850px; margin: 0 auto; padding-top: 40px; }
        
        /* بخش سربرگ و شعار */
        header { text-align: center; margin-bottom: 50px; }
        h1 { 
            color: #1a73e8; 
            font-size: 3.8rem; 
            margin: 0; 
            font-weight: 700;
            letter-spacing: -1px;
        }
        .slogan { 
            color: #1a73e8; 
            font-size: 1.15rem; 
            margin-top: 0px; 
            font-weight: 400;
            opacity: 0.85;
        }

        /* بخش جستجو */
        .search-box { display: flex; gap: 10px; margin-bottom: 40px; justify-content: center; }
        input { 
            padding: 15px; 
            width: 65%; 
            border-radius: 12px; 
            border: 1px solid #d1d5db; 
            font-family: 'Vazirmatn'; 
            font-size: 1rem;
            outline: none;
            transition: border-color 0.2s;
        }
        input:focus { border-color: #1a73e8; box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1); }
        .btn-search { 
            padding: 12px 35px; 
            border-radius: 12px; 
            border: none; 
            background: #1a73e8; 
            color: white; 
            cursor: pointer; 
            font-weight: bold; 
            font-family: 'Vazirmatn';
            font-size: 1rem;
        }

        /* کارت‌های پروژه */
        .card { 
            background: white; 
            padding: 25px; 
            margin-bottom: 20px; 
            border-radius: 18px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.04);
            border-right: 6px solid #1a73e8;
            text-align: right;
            transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-2px); }

        .details { 
            display: none; 
            margin-top: 20px; 
            padding: 20px; 
            background: #f8fafc; 
            border-radius: 12px; 
            border: 1px solid #e2e8f0;
            line-height: 1.8;
        }
        
        .btn-expand { 
            background: #f0f7ff; 
            border: 1px solid #1a73e8; 
            color: #1a73e8; 
            padding: 8px 20px; 
            border-radius: 25px; 
            cursor: pointer; 
            margin-top: 15px; 
            font-family: 'Vazirmatn';
            font-size: 0.85rem;
            font-weight: bold;
        }

        /* دکمه جدید برای کارگاه‌ها */
        .btn-workshop {
            display: inline-block;
            margin-top: 10px;
            background: #1a73e8;
            color: white;
            text-decoration: none;
            padding: 8px 18px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: bold;
            transition: background 0.2s;
        }
        .btn-workshop:hover { background: #1557b0; }

        .paywall { 
            background: #fffbeb; 
            padding: 30px; 
            border-radius: 18px; 
            border: 1px solid #fde68a; 
            margin-top: 30px; 
            text-align: center;
        }
        .premium-btn { 
            background: #10b981; 
            color: white; 
            border: none; 
            padding: 12px 25px; 
            border-radius: 12px; 
            cursor: pointer; 
            font-family: 'Vazirmatn'; 
            font-weight: bold; 
            margin-top: 15px;
            font-size: 1rem;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>پژولوژیست</h1>
        <p class="slogan">یک قدم فراتر از کارگاه؛ آموزش عملی روی پروژه‌های واقعی</p>
    </header>

    <div class="search-box">
        <input type="text" id="searchInput" placeholder="نام استاد یا کلمه کلیدی را جستجو کنید...">
        <button class="btn-search" onclick="searchProjects()">جستجو</button>
    </div>

    <div id="results"></div>
</div>

<script>
    async function searchProjects() {
        const query = document.getElementById('searchInput').value;
        const resultsDiv = document.getElementById('results');
        
        if (!query) return;
        
        resultsDiv.innerHTML = '<p style="text-align:center; color:#64748b;">در حال جستجو در بانک پروژه‌ها...</p>';

        try {
            // آدرس به سرور Render شما تغییر یافت
            const response = await fetch(`https://pajologist.onrender.com/search?field=${encodeURIComponent(query)}`);
            const data = await response.json();
            resultsDiv.innerHTML = '';

            if (!data.results || data.results.length === 0) {
                resultsDiv.innerHTML = '<p style="text-align:center; padding:40px;">نتیجه‌ای یافت نشد. کلمات کلیدی دیگری را امتحان کنید.</p>';
                return;
            }

            data.results.forEach((project, index) => {
                resultsDiv.innerHTML += `
                    <div class="card">
                        <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                            <small style="color: #64748b; background:#f1f5f9; padding:2px 10px; border-radius:10px;">${project.field}</small>
                            <small style="color: #64748b;">استاد: <strong>${project.prof}</strong></small>
                        </div>
                        <h3 style="margin: 15px 0 10px 0; color:#1e293b;">${project.title}</h3>
                        
                        <button class="btn-expand" onclick="toggleDetails(${index})">مشاهده جزئیات</button>
                        
                        <div id="details-${index}" class="details">
                            <p><strong>خلاصه طرح:</strong> ${project.summary}</p>
                            <p><strong>پیش‌نیاز مهارتی:</strong> ${project.special_req}</p>
                            <div style="margin-top:15px; padding:15px; background:#eff6ff; border-radius:12px; border-right:4px solid #3b82f6;">
                                <p style="color: #1e293b; font-size: 0.95rem; margin:0 0 10px 0;">
                                    مهارت لازم رو نداری؟ با کارگاه‌های پژولوژیست مهارت‌های به درد بخورت رو یاد می‌گیری، نه بیشتر و نه کمتر.
                                </p>
                                <a href="http://medicalresearch.ir/" target="_blank" class="btn-workshop">ورود به کارگاه‌ها</a>
                            </div>
                        </div>
                    </div>
                `;
            });

            resultsDiv.innerHTML += `
                <div class="paywall">
                    <p style="font-size:1.1rem; color:#92400e;"><strong>${data.message}</strong></p>
                    <p style="color:#b45309; font-size:0.9rem;">برای دسترسی به تمام پروژه‌ها و پکیج‌های آموزشی اختصاصی، عضو خانواده پرمیوم شوید.</p>
                    <button class="premium-btn">ارتقاء به پنل پرمیوم و شروع یادگیری</button>
                </div>
            `;

        } catch (error) {
            resultsDiv.innerHTML = '<p style="color:red; text-align:center;">خطا در برقراری ارتباط با سرور آنلاین.</p>';
        }
    }

    function toggleDetails(index) {
        const div = document.getElementById(`details-${index}`);
        const isHidden = div.style.display === "none" || div.style.display === "";
        div.style.display = isHidden ? "block" : "none";
    }
</script>

</body>
</html>